# ðŸ™¾  bga-arena-scoreboard
Filter ranking of players in BGA Arena

## âœ¨ Demo
![GIF Demo](https://raw.githubusercontent.com/DavidEGx/bga-arena-scoreboard/main/demo.gif?token=AAIB2POYM6LBERGEGLOABBK7ALHGU)

## ðŸ“¦ Setup
Create a new bookmark in your browser that points to this "address":

    javascript:(function()%20%7B%20'use%20strict'%3B%20const%20REQUEST_INTERVAL%20%3D%20300%3BcreateUi()%3B%20function%20createUi()%20%7B%20const%20ui%20%3D%20document.createElement('div')%3B%20const%20countryLbl%3D%20document.createElement('p')%3B%20const%20countrySel%3D%20document.createElement('select')%3B%20const%20userLbl%20%3D%20document.createElement('p')%3B%20const%20userList%3D%20document.createElement('textArea')%3B%20const%20limitsLbl%20%3D%20document.createElement('p')%3B%20const%20limitUInput%20%3D%20document.createElement('input')%3B%20const%20limitRInput%20%3D%20document.createElement('input')%3B%20const%20progressLbl%20%3D%20document.createElement('p')%3B%20const%20button%3D%20document.createElement('a')%3BcountrySel.id%3D%20'sbCountrySelector'%3B%20userList.id%3D%20'sbUserList'%3B%20progressLbl.id%20%3D%20'sbProgressLbl'%3B%20countryLbl.innerText%3D%20'Country%20filter%3A'%3B%20userLbl.innerText%20%3D%20'User%20filter%3A'%3B%20limitsLbl.innerText%20%3D%20'Limits%3A'%3B%20progressLbl.innerText%20%3D%20'Running...'%3B%20for%20(const%20%5Bkey%2C%20value%5D%20of%20Object.entries(COUNTRIES()))%20%7B%20const%20option%20%3D%20document.createElement('option')%3B%20option.value%20%3D%20key%3B%20option.text%20%3D%20value%3B%20countrySel.appendChild(option)%3B%20%7D%20userList.style.display%20%3D%20'block'%3B%20userList.style.width%20%3D%20'100%25'%3B%20userList.style.height%3D%20'40%25'%3B%20limitUInput.type%3D%20'number'%3B%20limitUInput.value%20%3D%2020%3B%20limitRInput.type%3D%20'number'%3B%20limitRInput.value%20%3D%201000%3B%20ui.appendChild(countryLbl)%3B%20ui.appendChild(countrySel)%3B%20ui.appendChild(userLbl)%3B%20ui.appendChild(userList)%3B%20ui.appendChild(limitsLbl)%3B%20ui.appendChild(limitUInput)%3B%20ui.appendChild(limitRInput)%3B%20ui.appendChild(button)%3B%20ui.style.position%20%3D%20'fixed'%3B%20ui.style.right%20%3D%20'0'%3B%20ui.style.top%20%3D%20'0'%3B%20ui.style.margin%20%3D%20'1em%201em'%3B%20ui.style.width%20%3D%20'400px'%3B%20ui.style.height%20%3D%20'300px'%3B%20ui.style.padding%20%3D%20'1.5em'%3B%20ui.style.backgroundColor%20%3D%20'%23eeefef'%3B%20ui.style.zIndex%20%3D%2099999%3B%20ui.style.border%20%3D%20'2px%20solid%20black'%3B%20ui.style.boxShadow%20%3D%20'7px%207px%20%23444'%3Bbutton.classList%20%3D%20'bgabutton%20bgabutton_blue'%3B%20button.innerText%20%3D%20'Run'%3B%20button.onclick%20%3D%20function()%20%7B%20const%20players%20%3D%20parsePlayers(userList.value)%3B%20run(countrySel.value%2C%20players%2C%20parseInt(limitUInput.value)%2C%20parseInt(limitRInput.value))%3Bbutton.style.display%20%3D%20'none'%3B%20ui.appendChild(progressLbl)%3B%20%7D%3Bdocument.body.appendChild(ui)%3B%20%7D%20async%20function%20run(country%2C%20playersToKeep%2C%20limitU%2C%20limitR)%20%7B%20const%20MAX_REQUESTS%20%3D%20limitR%20%2F%2010%3B%20for%20(let%20i%20%3D%200%3B%20i%20%3C%20MAX_REQUESTS%3B%20i%2B%2B)%20%7B%20await%20loadMorePlayers()%3B%20removePlayers(country%2C%20playersToKeep)%3Bconst%20playersSoFar%20%3D%20getVisiblePlayers()%3B%20if%20(playersToKeep.length%20%3E%200%20%26%26%20playersToKeep.length%20%3D%3D%3D%20playersSoFar.length)%20%7B%20break%3B%20%7Dif%20(playersSoFar.length%20%3E%3D%20limitU)%20%7B%20let%20i%20%3D%200%3B%20for%20(const%20player%20of%20getVisiblePlayers())%20%7B%20if%20(i%20%3E%3D%20limitU)%20%7B%20player.classList.add('hidden')%3B%20%7D%20i%2B%2B%3B%20%7D%20break%3B%20%7Dawait%20new%20Promise(done%20%3D%3E%20setTimeout(()%20%3D%3E%20done()%2C%20REQUEST_INTERVAL))%3B%20%7Dconst%20progressLbl%20%3D%20document.getElementById('sbProgressLbl')%3B%20const%20userList%3D%20document.getElementById('sbUserList')%3B%20const%20countrySel%20%3D%20document.getElementById('sbCountrySelector')%3B%20progressLbl.innerText%20%3D%20'Done!'%3B%20progressLbl.style.color%20%3D%20'green'%3BcountrySel.addEventListener('change'%2C%20function%20()%20%7B%20resetList()%3B%20const%20players%20%3D%20parsePlayers(userList.value)%3B%20removePlayers(countrySel.value%2C%20players)%3B%20%7D)%3B%20userList.addEventListener('change'%2C%20function%20()%20%7B%20resetList()%3B%20const%20players%20%3D%20parsePlayers(userList.value)%3B%20removePlayers(countrySel.value%2C%20players)%3B%20%7D)%3B%20%7D%20async%20function%20loadMorePlayers()%20%7B%20const%20button%20%3D%20document.querySelector('%23seemoreRanking')%20%7C%7C%20document.querySelector('%23seemore')%20%7C%7C%20document.querySelector('%23seemore_rankings')%20%7C%7C%20document.querySelector('%23prestige_see_more')%3B%20button.click()%3B%20await%20new%20Promise(done%20%3D%3E%20setTimeout(()%20%3D%3E%20done()%2C%20REQUEST_INTERVAL))%3B%20%7D%20function%20getPlayers()%20%7B%20if%20(document.getElementById('mainRanking'))%20%7B%20return%20document.querySelectorAll('%23mainRanking%20.player_in_list')%3B%20%7D%20else%20%7B%20return%20document.querySelectorAll('.gameranking%20.player_in_list')%3B%20%7D%20%7D%20function%20getVisiblePlayers()%20%7B%20if%20(document.getElementById('mainRanking'))%20%7B%20return%20document.querySelectorAll('%23mainRanking%20.player_in_list%3Anot(.hidden)')%3B%20%7D%20else%20%7B%20return%20document.querySelectorAll('.gameranking%20.player_in_list%3Anot(.hidden)')%3B%20%7D%20%7D%20function%20parsePlayers(playersStr)%20%7B%20const%20commaValues%20%3D%20playersStr.split('%2C')%3B%20const%20semicolonValues%20%3D%20playersStr.split('%3B')%3B%20const%20newlineValues%20%3D%20playersStr.split('%5Cn')%3B%20const%20usersFound%20%3D%20Math.max(commaValues.length%2C%20semicolonValues.length%2C%20newlineValues.length)%3Blet%20players%3B%20if%20(commaValues.length%20%3D%3D%3D%20usersFound)%20%7B%20players%20%3D%20commaValues%3B%20%7D%20else%20if%20(semicolonValues.length%20%3D%3D%20usersFound)%20%7B%20players%20%3D%20semicolonValues%3B%20%7D%20else%20if%20(newlineValues.length%20%3D%3D%20usersFound)%20%7B%20players%20%3D%20newlineValues%3B%20%7Dplayers%20%3D%20players.filter(x%20%3D%3E%20x)%3B%20return%20players%3B%20%7D%20function%20removePlayers(country%2C%20playersToKeep)%20%7B%20playersToKeep%20%3D%20playersToKeep.map(p%20%3D%3E%20p.toLowerCase())%3Bfor%20(const%20player%20of%20getVisiblePlayers())%20%7B%20const%20name%20%3D%20player.querySelector('a.playername').innerText.toLowerCase()%3Bif%20(country%20%26%26%20country%20!%3D%20player.querySelector('.flag').style.backgroundPosition)%20%7B%20player.classList.add('hidden')%3B%20%7Dif%20(playersToKeep.length%20%3E%200%20%26%26%20!playersToKeep.includes(name))%20%7B%20player.classList.add('hidden')%3B%20%7D%20%7D%20%7D%20function%20resetList()%20%7B%20Array.from(getPlayers()).forEach((el)%20%3D%3E%20el.classList.remove('hidden'))%3B%20%7Dfunction%20COUNTRIES()%20%7B%20return%20%7B%20''%3A%20'Any%20country'%2C%20'0px%20-55px'%3A%20'Albania'%2C%20'0px%20-99px'%3A%20'Argentina'%2C%20'-16px%20-22px'%3A%20'Australia'%2C%20'-48px%20-33px'%3A%20'Belarus'%2C%20'-16px%20-99px'%3A%20'Belgium'%2C%20'-32px%20-88px'%3A%20'Brazil'%2C%20'-48px%20-55px'%3A%20'Canada'%2C%20'-64px%20-44px'%3A%20'Chile'%2C%20'-144px%20-88px'%3A%20'Croatia'%2C%20'-64px%20-77px'%3A%20'Colombia'%2C%20'-80px%20-44px'%3A%20'Czech%20Republic'%2C%20'-80px%20-99px'%3A%20'Dominican%20Republic'%2C%20'-112px%20-66px'%3A%20'France'%2C%20'-112px%20-11px'%3A%20'Finland'%2C%20'-128px%20-0px'%3A%20'Georgia'%2C%20'-80px%20-55px'%3A%20'Germany'%2C%20'-128px%20-99px'%3A%20'Greece'%2C%20'-144px%20-11px'%3A%20'Guatemala'%2C%20'-144px%20-55px'%3A%20'Hong%20Kong'%2C%20'-160px%20-0px'%3A%20'Hungary'%2C%20'-160px%20-99px'%3A%20'Italy'%2C%20'-160px%20-33px'%3A%20'Israel'%2C%20'-176px%20-0px'%3A%20'Jamaica'%2C%20'-176px%20-22px'%3A%20'Japan'%2C%20'-192px%20-33px'%3A%20'Kazakhstan'%2C%20'-208px%20-33px'%3A%20'Latvia'%2C%20'-208px%20-11px'%20%3A%20'Lithuania'%2C%20'-240px%20-55px'%3A%20'Malaysia'%2C%20'-224px%20-0px'%3A%20'Marshall%20Islands'%2C%20'-240px%20-11px'%3A%20'Mauritius'%2C%20'-240px%20-44px'%3A%20'Mexico'%2C%20'-224px%20-99px'%3A%20'Montserrat'%2C%20'-256px%20-33px'%3A%20'Netherlands'%2C%20'-256px%20-0px'%3A%20'Norfolk%20Island'%2C%20'-176px%20-99px'%3A%20'North%20Korea'%2C%20'-256px%20-44px'%3A%20'Norway'%2C%20'-272px%20-11px'%3A%20'Peru'%2C%20'-272px%20-66px'%3A%20'Poland'%2C%20'-288px%20-11px'%3A%20'Portugal'%2C%20'-288px%20-66px'%3A%20'Romania'%2C%20'-288px%20-88px'%3A%20'Russian%20Federation'%2C%20'-304px%20-22px'%3A%20'Seychelles'%2C%20'-304px%20-66px'%3A%20'Singapore'%2C%20'-320px%20-0px'%3A%20'Slovakia'%2C%20'-192px%20-0px'%3A%20'South%20Korea'%2C%20'-96px%20-77px'%3A%20'Spain'%2C%20'-304px%20-55px'%3A%20'Sweden'%2C%20'-64px%20-11px'%3A%20'Switzerland'%2C%20'-352px%20-44px'%3A%20'Taiwan'%2C%20'-336px%20-44px'%3A%20'Thailand'%2C%20'-336px%20-33px'%3A%20'Togo'%2C%20'-352px%20-33px'%3A%20'Tuvalu'%2C%20'0px%20-11px'%3A%20'United%20Arab%20Emirates'%2C%20'-112px%20-88px'%3A%20'United%20Kingdom'%2C%20'-352px%20-99px'%3A%20'United%20States'%2C%20'-384px%20-99px'%3A%20'Unknown'%2C%20'-352px%20-66px'%3A%20'Ukraine'%2C%20'-368px%20-22px'%3A%20'Vatican'%2C%20'-368px%20-44px'%3A%20'Venezuela'%2C%20'-368px%20-77px'%3A'Viet%20Nam'%20%7D%3B%20%7D%7D)()%3B

## ðŸš€ Usage
1. Go to the raking page for a given game and season (for example: https://boardgamearena.com/halloffame?game=1&season=12)
2. Click on the bookmark you created during setup.
3. Paste a list of players separated by commas.
4. Click ok and wait until the list is complete.

## ðŸ‘· Contributing
1. Change whatever you need inside [src/score.js](src/score.js).
2. Update bookmarlet in README.md by running [bin/update_readme](bin/update_readme) (requires [nodejs](https://nodejs.dev/)).
3. Test, commit, push, PR.

## ðŸ“œ License
[GPL v3](https://www.gnu.org/licenses/gpl-3.0.en.html)
